# Mobile games data analysis project
### Анализ метрик и результатов A/B-теста в компании по разработке игр для мобильных устройств

**Контекст и задача**  
В рамках учебного проекта необходимо было представить, что я работаю в компании, которая разрабатывает мобильные игры. Есть ряд задач по исследованию нескольких аспектов мобильного приложения:
В первую очередь, интересует показатель retention. Необходимо написать функцию для его подсчета.
Помимо этого, в компании провели A/B-тестирование наборов акционных предложений. На основе имеющихся данных необходимо определить, какой набор можно считать лучшим и на основе каких метрик стоит принять правильное решение.
В третьих необходимо описать метрики для оценки результатов последнего прошедшего тематического события в игре.
В качестве исходных данных представлены 2 таблицы (в временем регистраций и авторизаций пользователя и другими данными) 

**Используемый стек**<br>
Проект выполнялся на python в Jupyter-ноутбуке. 
В ходе выполнения проекта использованы библиотеки pandas, seaborn, numpy, statsmodels, pingouin, scipy и другие

**Этапы работы:** <br> 
1. Необходимо написать функцию для анализа retention. Считаны csv-файлы с яндекс.диска, используя requests и api яндекса и созданы столбцы с временем авторизации и регистрации пользователя
2. Предварительный анализ данных:
   Всего зарегистрировано 1000000 юзеров.
   В датасете reg_data представлены даты регистрации для каждого uid.
   Даты регистрации находятся в диапазоне от 1998-11-18 до 2020-09-23
   В датасете auth_data представлены даты каждого входа юзеров в игру
   Даты входа в игру находятся в диапазоне от 1998-11-18 до 2020-09-23
   Пропущенные значения отсутствуют
   Дубликаты отсутствуют
3. Объединил таблицы и пользователей поделил на когорты по дню регистрации. Буду считать отвалившимися пользователями тех, кто не заходил в игру более 14 дней с момента установки. Таким образом, retention будем смотреть только для первых 15 дней.
Для примера retention посчитаю только для актуальных данных (актуальными буду считать данные начиная с 2020 г.) и буду считать по дням, начиная со дня регистрации пользователя только по понедельникам (каждая когорта - пользователи, зарегистрировавшиеся в очередной понедельник).
Создал когорты и визуализировал через pandas и дополнительно через seaborn
_NB: Таблица retention не отображается в гитхабе с цветовыми градиентами, для полноценного отображения необходимо запустить notebook в любой IDE (Github disables CSS and javascript in their rendered notebooks as a security measure.). Для отображения в гитхабе дополнительно добавлена визуализация через seaborn._
4. Итоговая функция принимает на вход ссылки на данные, требуемый период обзора и день недели, на выходе выдаёт heatmap-таблицу Retention.
  
5. Имеются результаты A/B теста, в котором двум группам пользователей предлагались различные наборы акционных предложений. Известно, что ARPU в тестовой группе выше на 5%, чем в контрольной. При этом в контрольной группе 1928 игроков из 202103 оказались платящими, а в тестовой – 1805 из 202667. Необходимо выбрать лучший набор предложений, выбрать и проанализировать метрики для принятия правильного решения. С
6. Считаны csv-файлы с яндекс.диска, используя requests и api яндекса. Проведеден предварительный анализ данных. Обе группы всех пользователей не имеют нормального распределения выручки, по результатам анализа qq-plot. Обе группы платящих пользователей не имеют нормального распределения выручки. Контрольная группа а имеет 2 ярко выраженные моды, то есть распределение не является унимодальным.
7. Проанализирую и сравню:
- ARPU
- ARPPU
- Медианную выручку на платящего пользователя
- Долю платящих юзеров
8. _ARPU_ Вследствие того, что в распределениях присутствуют большие выбросы, простой bootstrap на сырых данных не дает возможность объективно сравнить ARPU, так как доверительный интервал ARPU тестовой группы попадает полностью в доверительный интервал ARPU контрольной группы. Для начала применим критерий Левена, чтобы определить равенство дисперсий в обоих группах. В качестве параметра зададим функцию median, рекомендованную для перекошенных распределений.
По результатам критерия Левена мы не может отклонить нулевую гипотезу, то есть дисперсии выручки на пользователя в обеих группах статистически значимо не отличаются.
9. Для сравнения ARPU применим двухвыборочный тест Колмогорова-Смирнова. Результаты теста показывают, что распределения в выборках статистически значимо отличаются друг от друга. Вероятность случайно взять из одной выборки более высокое значение, чем из другой больше 50% По результатам теста можно заявить, что в группе b значение ARPU значимо выше, чем в контрольной группе 
10. _ARPPU_ Для статистической проверки утверждения сформулируем нулевую гипотезу: "ARPPU в тестовой и контрольной группе не различаются статистически значимо"
Для сравнения ARPPU применим bootstrap-тест (так как распределения имеют разную форму, критерий Крускалла-Уоллиса неприменим).
Так как в группе b имеется довольно большое количество выбросов (высоких значений), является целесообразным прологарифмировать значения revenue с целью сделать распределение более сглаженным.
11. По результатам bootstrap-теста по прологарифирмированным данным, доверительный интервал среднего тестовой группы b выше доверительного интервала контрольной группы a, таким образом можно утверждать, что ARPPU тестовой группы значимо выше ARPPU контрольной группы.
12. Дополнительно сравним _медиану выручки на платящего пользователя_ по сырым данным (также использовaн bootstrap).
По результатам проведенных тестов, доверительный интервал медианы группы a (контрольной) значительно ниже доверительного интервала медианы тестовой группы.
13. В качестве последней метрики сравним _доли плятящих юзеров_.
По результатам предварительного подсчета, доля платящих юзеров в контрольной группе несколько выше доли платящих юзеров в тестовой группе. Проверим это статистически, нулевая гипотеза "Нулевая гипотеза - доля платящих юзеров статистически значимо не различается в обоих группах"
14. Для стат.проверки использую proportions z-test
Так как p-value составляет 0.035, можно утверждать, что в генеральной совокупности доля платящих юзеров в тестовой и контрольной группых статистически значимо различается (доля платящих юзеров выше в контрольной группе)
  
**Результат**<br>
Таким образом,

- Распределения в выборках статистически значимо отличаются друг от друга. Вероятность случайно взять из одной выборки более высокое значение, чем из другой больше 50%
- ARPU тестовой группы значимо выше ARPU контрольной группы.
- ARPPU тестовой группы значимо выше ARPPU контрольной группы.
- Медиана выручки на платящего пользователя тестовой группы статистически значимо и значительно выше медианы контрольной группы.
- При этом, доля платящих юзеров в тестовой и контрольной группых статистически значимо различается (доля платящих юзеров выше в контрольной группе)

На основании полученных данных можно заключить, что тестовая группа является предпочтительной
Стоит заметить, что дизайн A/B-теста, по результатам которого получены данные, вероятно, был нарушен, так как в тестовой и контрольной группе находятся абсолютно непересекающиеся сегменты пользователей по выручке. Для проверки данного утверждения необходимо видеть, как было проведено сплитование, как был проведен A/A-тест, а также в чем заключался эксперимент. Если это утверждение верно, потребуется повторное сплитование и перезапуск эксперимента
